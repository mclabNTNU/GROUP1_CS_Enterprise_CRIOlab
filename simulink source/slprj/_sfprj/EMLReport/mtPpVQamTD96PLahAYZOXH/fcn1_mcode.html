<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T11U3">eta_v</span> = fcn(<span class="var type1" id="S3T2U6">s</span>,<span class="var type1" id="S4T1U7">c</span>,<span class="var type1" id="S5T1U8">r</span>,<span class="var type1" id="S6T2U9">U_ref</span>,<span class="var type1" id="S7T2U10">psi</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T7:U7"><span class="var type1" id="S8T7U13">eta_d</span> = <span class="mxinfo " id="T7:U9">[<span class="mxinfo " id="T2:U10"><span class="mxinfo " id="T2:U11"><span class="var type1" id="S4T1U18">c</span>(<span class="mxinfo " id="T2:U13">1</span>)</span> + <span class="mxinfo " id="T2:U14"><span class="mxinfo " id="T2:U15"><span class="var type1" id="S5T1U22">r</span>(1)</span>*<span class="mxinfo " id="T2:U17">cos(<span class="mxinfo " id="T2:U18"><span class="mxinfo " id="T2:U19">2*pi</span>*<span class="var type1" id="S3T2U31">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T7:U7"><span class="mxinfo " id="T7:U9">         <span class="mxinfo " id="T2:U21"><span class="mxinfo " id="T2:U22"><span class="var type1" id="S4T1U35">c</span>(<span class="mxinfo " id="T2:U24">2</span>)</span> + <span class="mxinfo " id="T2:U25"><span class="mxinfo " id="T2:U26"><span class="var type1" id="S5T1U39">r</span>(2)</span>*<span class="mxinfo " id="T2:U28">sin(<span class="mxinfo " id="T2:U29"><span class="mxinfo " id="T2:U30">2*pi</span>*<span class="var type1" id="S3T2U48">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T7:U7"><span class="mxinfo " id="T7:U9">         <span class="mxinfo " id="T2:U32">atan2(<span class="mxinfo " id="T2:U33"><span class="mxinfo " id="T2:U34">-<span class="mxinfo " id="T2:U35"><span class="var type1" id="S5T1U55">r</span>(2)</span></span>*<span class="mxinfo " id="T2:U37">cos(<span class="mxinfo " id="T2:U38"><span class="mxinfo " id="T2:U39">2*pi</span>*<span class="var type1" id="S3T2U64">s</span></span>)</span></span>,<span class="mxinfo " id="T2:U41"><span class="mxinfo " id="T2:U42"><span class="var type1" id="S5T1U67">r</span>(1)</span>*<span class="mxinfo " id="T2:U44">sin(<span class="mxinfo " id="T2:U45"><span class="mxinfo " id="T2:U46">2*pi</span>*<span class="var type1" id="S3T2U76">s</span></span>)</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%wrapping psi_d     </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% persistent k;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% k=0;              </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="comment">% if abs((eta_d(3)+(2*pi*k))-(psi)) &gt; pi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="comment">%    if (psi) &lt; eta_d(3)+(2*pi*k)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="comment">%        k = k-1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="comment">%    elseif (psi) &gt; eta_d(3)+(2*pi*k)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="comment">%        k = k+1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="comment">%    end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="comment">% end </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="var type0" id="S8T0U80">eta_d</span>(3)=<span class="mxinfo " id="T2:U48"><span class="var type1" id="S8T7U84">eta_d</span>(<span class="mxinfo " id="T2:U50">3</span>)</span>+(<span class="mxinfo " id="T2:U51"><span class="mxinfo " id="T2:U52">2</span>*<span class="mxinfo " id="T2:U53">pi</span></span>*<span class="message error" id="M1F1C">k</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T7:U54"><span class="var type1" id="S14T7U96">eta_ds</span> = <span class="mxinfo " id="T7:U56"><span class="mxinfo " id="T2:U57">2*pi</span>*<span class="mxinfo " id="T7:U58">[<span class="mxinfo " id="T2:U59"><span class="mxinfo " id="T2:U60">-<span class="mxinfo " id="T2:U61"><span class="var type1" id="S5T1U107">r</span>(1)</span></span>*<span class="mxinfo " id="T2:U63">sin(<span class="mxinfo " id="T2:U64"><span class="mxinfo " id="T2:U65">2*pi</span>*<span class="var type1" id="S3T2U116">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T7:U54"><span class="mxinfo " id="T7:U56"><span class="mxinfo " id="T7:U58">                <span class="mxinfo " id="T2:U67"><span class="mxinfo " id="T2:U68"><span class="var type1" id="S5T1U120">r</span>(2)</span>*<span class="mxinfo " id="T2:U70">cos(<span class="mxinfo " id="T2:U71"><span class="mxinfo " id="T2:U72">2*pi</span>*<span class="var type1" id="S3T2U129">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T7:U54"><span class="mxinfo " id="T7:U56"><span class="mxinfo " id="T7:U58">               <span class="mxinfo " id="T2:U74">(<span class="mxinfo " id="T2:U75"><span class="mxinfo " id="T2:U76">-<span class="mxinfo " id="T2:U77"><span class="var type1" id="S5T1U136">r</span>(1)</span></span>*<span class="mxinfo " id="T2:U79"><span class="var type1" id="S5T1U139">r</span>(2)</span></span>)/(<span class="mxinfo " id="T2:U81"><span class="mxinfo " id="T2:U82"><span class="mxinfo " id="T2:U83"><span class="mxinfo " id="T2:U84"><span class="var type1" id="S5T1U146">r</span>(2)</span>^2</span>*<span class="mxinfo " id="T2:U86"><span class="mxinfo " id="T2:U87">cos(<span class="mxinfo " id="T2:U88"><span class="mxinfo " id="T2:U89">2*pi</span>*<span class="var type1" id="S3T2U157">s</span></span>)</span>^2</span></span> + <span class="mxinfo " id="T2:U91"><span class="mxinfo " id="T2:U92"><span class="mxinfo " id="T2:U93"><span class="var type1" id="S5T1U162">r</span>(1)</span>^2</span>*<span class="mxinfo " id="T2:U95"><span class="mxinfo " id="T2:U96">sin(<span class="mxinfo " id="T2:U97"><span class="mxinfo " id="T2:U98">2*pi</span>*<span class="var type1" id="S3T2U173">s</span></span>)</span>^2</span></span></span>)</span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T7:U100"><span class="var type1" id="S15T7U177">eta_dss</span> = <span class="mxinfo " id="T7:U102"><span class="mxinfo " id="T2:U103">(2*pi)^2</span>*<span class="mxinfo " id="T7:U104">[<span class="mxinfo " id="T2:U105"><span class="mxinfo " id="T2:U106">-<span class="mxinfo " id="T2:U107"><span class="var type1" id="S5T1U191">r</span>(1)</span></span>*<span class="mxinfo " id="T2:U109">cos(<span class="mxinfo " id="T2:U110"><span class="mxinfo " id="T2:U111">2*pi</span>*<span class="var type1" id="S3T2U200">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T7:U100"><span class="mxinfo " id="T7:U102"><span class="mxinfo " id="T7:U104">                     <span class="mxinfo " id="T2:U113"><span class="mxinfo " id="T2:U114">-<span class="mxinfo " id="T2:U115"><span class="var type1" id="S5T1U205">r</span>(2)</span></span>*<span class="mxinfo " id="T2:U117">sin(<span class="mxinfo " id="T2:U118"><span class="mxinfo " id="T2:U119">2*pi</span>*<span class="var type1" id="S3T2U214">s</span></span>)</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T7:U100"><span class="mxinfo " id="T7:U102"><span class="mxinfo " id="T7:U104">                     <span class="mxinfo " id="T2:U121">(<span class="mxinfo " id="T2:U122"><span class="mxinfo " id="T2:U123"><span class="mxinfo " id="T2:U124"><span class="mxinfo " id="T2:U125"><span class="mxinfo " id="T2:U126">4</span>*<span class="mxinfo " id="T2:U127"><span class="var type1" id="S5T1U224">r</span>(2)</span></span>*<span class="mxinfo " id="T2:U129"><span class="var type1" id="S5T1U227">r</span>(1)</span></span>*(<span class="mxinfo " id="T2:U131"><span class="mxinfo " id="T2:U132"><span class="mxinfo " id="T2:U133"><span class="var type1" id="S5T1U233">r</span>(2)</span>^2</span> - <span class="mxinfo " id="T2:U135"><span class="mxinfo " id="T2:U136"><span class="var type1" id="S5T1U238">r</span>(1)</span>^2</span></span>)</span>*<span class="mxinfo " id="T2:U138">sin(<span class="mxinfo " id="T2:U139"><span class="mxinfo " id="T2:U140">2*2*pi</span>*<span class="var type1" id="S3T2U250">s</span></span>)</span></span>)/<span class="mxinfo " id="T2:U142">(<span class="mxinfo " id="T2:U143"><span class="mxinfo " id="T2:U144"><span class="mxinfo " id="T2:U145"><span class="mxinfo " id="T2:U146"><span class="mxinfo " id="T2:U147"><span class="var type1" id="S5T1U258">r</span>(2)</span>^2</span> + <span class="mxinfo " id="T2:U149"><span class="mxinfo " id="T2:U150"><span class="var type1" id="S5T1U263">r</span>(1)</span>^2</span></span> + <span class="mxinfo " id="T2:U152"><span class="mxinfo " id="T2:U153"><span class="mxinfo " id="T2:U154"><span class="var type1" id="S5T1U269">r</span>(2)</span>^2</span>*<span class="mxinfo " id="T2:U156">cos(<span class="mxinfo " id="T2:U157"><span class="mxinfo " id="T2:U158">2*2*pi</span>*<span class="var type1" id="S3T2U281">s</span></span>)</span></span></span> - <span class="mxinfo " id="T2:U160"><span class="mxinfo " id="T2:U161"><span class="mxinfo " id="T2:U162"><span class="var type1" id="S5T1U285">r</span>(1)</span>^2</span>*<span class="mxinfo " id="T2:U164">cos(<span class="mxinfo " id="T2:U165"><span class="mxinfo " id="T2:U166">2*2*pi</span>*<span class="var type1" id="S3T2U297">s</span></span>)</span></span></span>)^2</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T2:U168"><span class="var type1" id="S16T2U301">U_s</span> = <span class="mxinfo " id="T2:U170"><span class="var type1" id="S6T2U303">U_ref</span>/(<span class="mxinfo " id="T2:U172">sqrt(<span class="mxinfo " id="T2:U173"><span class="mxinfo " id="T2:U174"><span class="mxinfo " id="T2:U175"><span class="mxinfo " id="T2:U176"><span class="var type1" id="S5T1U311">r</span>(1)</span>^2</span> * <span class="mxinfo " id="T2:U178"><span class="mxinfo " id="T2:U179">sin(<span class="mxinfo " id="T2:U180"><span class="mxinfo " id="T2:U181">2*pi</span>*<span class="var type1" id="S3T2U322">s</span></span>)</span>^2</span></span> + <span class="mxinfo " id="T2:U183"><span class="mxinfo " id="T2:U184"><span class="mxinfo " id="T2:U185"><span class="var type1" id="S5T1U327">r</span>(2)</span>^2</span> * <span class="mxinfo " id="T2:U187"><span class="mxinfo " id="T2:U188">cos(<span class="mxinfo " id="T2:U189"><span class="mxinfo " id="T2:U190">2*pi</span>*<span class="var type1" id="S3T2U338">s</span></span>)</span>^2</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T2:U192"><span class="var type1" id="S18T2U342">U_ss</span> = <span class="mxinfo " id="T2:U194"><span class="mxinfo " id="T2:U195"><span class="mxinfo " id="T2:U196">-<span class="var type1" id="S6T2U346">U_ref</span></span>*(<span class="mxinfo " id="T2:U198"><span class="mxinfo " id="T2:U199"><span class="mxinfo " id="T2:U200"><span class="mxinfo " id="T2:U201"><span class="mxinfo " id="T2:U202"><span class="mxinfo " id="T2:U203"><span class="var type1" id="S5T1U354">r</span>(1)</span>^2</span>*<span class="mxinfo " id="T2:U205">sin(<span class="mxinfo " id="T2:U206"><span class="mxinfo " id="T2:U207">2*pi</span>*<span class="var type1" id="S3T2U364">s</span></span>)</span></span>*<span class="mxinfo " id="T2:U209">(2*pi)^3</span></span>*<span class="mxinfo " id="T2:U210">cos(<span class="mxinfo " id="T2:U211"><span class="mxinfo " id="T2:U212">2*pi</span>*<span class="var type1" id="S3T2U379">s</span></span>)</span></span>-<span class="mxinfo " id="T2:U214"><span class="mxinfo " id="T2:U215"><span class="mxinfo " id="T2:U216"><span class="mxinfo " id="T2:U217"><span class="mxinfo " id="T2:U218"><span class="var type1" id="S5T1U385">r</span>(2)</span>^2</span>*<span class="mxinfo " id="T2:U220">cos(<span class="mxinfo " id="T2:U221"><span class="mxinfo " id="T2:U222">2*pi</span>*<span class="var type1" id="S3T2U395">s</span></span>)</span></span>*<span class="mxinfo " id="T2:U224">(2*pi)^3</span></span>*<span class="mxinfo " id="T2:U225">sin(<span class="mxinfo " id="T2:U226"><span class="mxinfo " id="T2:U227">2*pi</span>*<span class="var type1" id="S3T2U410">s</span></span>)</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T2:U192"><span class="mxinfo " id="T2:U194">    <span class="mxinfo " id="T2:U229">(<span class="mxinfo " id="T2:U230"><span class="mxinfo " id="T2:U231">(<span class="mxinfo " id="T2:U232"><span class="mxinfo " id="T2:U233"><span class="mxinfo " id="T2:U234">2*pi</span>*<span class="mxinfo " id="T2:U235">-<span class="mxinfo " id="T2:U236"><span class="var type1" id="S5T1U424">r</span>(1)</span></span></span>*<span class="mxinfo " id="T2:U238">sin(<span class="mxinfo " id="T2:U239"><span class="mxinfo " id="T2:U240">2*pi</span>*<span class="var type1" id="S3T2U433">s</span></span>)</span></span>)^2</span> + <span class="mxinfo " id="T2:U242">(<span class="mxinfo " id="T2:U243"><span class="mxinfo " id="T2:U244"><span class="mxinfo " id="T2:U245"><span class="mxinfo " id="T2:U246"><span class="var type1" id="S5T1U441">r</span>(2)</span>*<span class="mxinfo " id="T2:U248">cos(<span class="mxinfo " id="T2:U249"><span class="mxinfo " id="T2:U250">2*pi</span>*<span class="var type1" id="S3T2U450">s</span></span>)</span></span>*<span class="mxinfo " id="T2:U252">2</span></span>*<span class="mxinfo " id="T2:U253">pi</span></span>)^2</span></span>)^1.5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T11:U254"><span class="var type1" id="S2T11U458">eta_v</span> = <span class="mxinfo " id="T11:U256">[<span class="var type1" id="S8T7U461">eta_d</span>; <span class="var type1" id="S14T7U463">eta_ds</span>; <span class="var type1" id="S15T7U465">eta_dss</span> ; <span class="var type1" id="S16T2U467">U_s</span>; <span class="var type1" id="S18T2U469">U_ss</span>]</span></span>;</span></span>
</pre>
